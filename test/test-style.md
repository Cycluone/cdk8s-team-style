
# 测试内容

## 内网穿透软件

- 全傻瓜需求：花生壳（有免费）

```
- 下载软件：<https://hsk.oray.com/>
- 官网帮助文档：<https://service.oray.com/question/10541.html>
- 下一步下一步安装
- 打开软件，微信扫码登录
- 点击右下角加号 "添加映射"，会跳转到花生壳官网
- 选择：【用户中心】--【花生壳管理】--【点击对应帐号】--【域名列表】
- 需要花费 6 块进行购买穿透服务，而且还要下载他们 APP 进行实名认证。这些挺坑的，其他就还好。
```


- 半傻瓜需求：natapp（有免费）

```
- 官网帮助文档：<https://natapp.cn/article/natapp_newbie>
- 官网注册账号
- 登录，点击左上角：购买免费隧道
- 填写映射的本地端口后会给你生成一个 authtoken
- Windows 系统
    - 修改 config.ini，填写 authtoken
    - 双击 natapp.exe 即可
- Linux、macOS
     - 赋权：chmod a+x natapp
     - 执行：./natapp -authtoken=9ab6b9040a624f40
- 执行成功会告诉你一个临时的免费域名，这个域名是动态的，每次启动都会变，所以相对比较麻烦。
```

- 全配置需求：[frp 支持 TCP、UDP、HTTP、HTTPS 等多种协议](https://gofrp.org/)
- 一般都要下载花生壳、natapp，它们都是有崩过的经历，所以别在关键时候掉链子了

## 测试流程

- 测试用例
- 测试数据
- 测试脚本
- 执行测试
- 测试报告
- 问题跟踪
- 数据库
    - 清洗隐私数据（密码、身份证、手机号、邮箱地址、居住地址）
    - 数据同步规则、同步周期

## 细节考虑

- 移动端设备电量、网络有限
- 注意电量、流量在各个业务场景下的使用情况

## 单元测试

- 业务主流程必写
- 出现 Bug 的流程必须补充

## Mock 测试

- YApi
- [Mock 手册](../dev/common/mock.md)

## UI 自动化测试

- 业务主流程必写
- 出现 Bug 的流程必须补充

## 接口自动化测试

- 业务主流程必写
- 核心模块必写
- 出现 Bug 的流程必须补充

## 压力测试

- 业务主流程必写
- 核心模块必写
- 出现 Bug 的流程必须补充
- 秒杀、促销必须压力测试
- 新架构基准测试


## 接口压力测试

- 业务 API 接口：95% Line 控制在 2 秒以内
- 底层 API 接口：95% Line 控制在 300 毫秒以内
- JVM 异常监控
    - VisualVM
    - JProfile

## 容量规划

- 长期容量规划
- 短期容量规划



## 性能

- 硬件
    - 升级带宽
    - 使用 SSD 硬盘
- 前端
    - 前端页面加载资源时间跟踪
    - 前端资源合并、压缩：HTML、CSS、JS
    - 前端图片预加载
    - 对DNS预获取
    - 样式放头部，脚本放底部
- 后端
    - 记录 SQL 执行时间
    - 记录方法执行时间
    - SQL 优化
    - 无状态设计，不采用 session 机制
    - 执行时间过长的方法需要上 Redis 等中间件缓存
    - 用户不需要立即知道响应结果的接口可以用多线程异步处理
    - 静态分离，静态资源托管到 OSS
    - 图片转换为 WebP 格式
    - 禁止没有缓存清空下循环、递归查询数据库
    - 一些临时的 key/value 结构数据可以存在 Redis 中
- 部署
    - 部署 CDN
    - 应用多节点部署
    - Nginx 配置 Etag 和 Expires 缓存配置
    - Nginx 开启 Gzip 压缩
- 监控
    - Prometheus + Grafana
    - GoAccess
    - Skywalking
    - 阿里云 ARMS 前端监控
        - 页面访问速度：首次渲染时间、首屏时间、DOM Ready 时间、资源加载时间等
        - API 请求监控：调用成功率、返回信息、平均耗时
        - JS 错误诊断：类似 Sentry












